id: github
version: "1.0"
title: GitHub
requirements:
  - homePage: https://cli.github.com
    which: gh
rootItems:
  - title: Open Sunbeam Repository
    script: open-repository
    with:
      - param: owner
        value: pomdtr
      - param: name
        value: sunbeam
  - title: List My Repositories
    script: list-repositories
    with:
      - param: owner
        value: pomdtr
  - title: List Owner Repositories
    script: list-repositories
    with:
      - param: owner
        value:
          type: textfield
          title: Owner
  - title: List Dailymotion Repositories
    script: list-repositories
    with:
      - param: owner
        value: dailymotion
  - title: List Airflow Pull Requests
    script: list-pull-requests
    with:
      - param: repository
        value: dailymotion/dwh-dags
scripts:
  open-repository:
    command: printf 'https://github.com/%s/%s' {{owner}} {{name}}
    onSuccess: open-in-browser
    params:
      owner:
        type: string
      name:
        type: string
  list-repositories:
    title: List Repositories
    command: ./list-repos.sh {{ owner }}
    onSuccess: push-page
    page:
      type: list
      mode: filter
      showPreview: true
    params:
      owner:
        type: string
  list-pull-requests:
    command: ./list-prs.sh {{ repository }}
    onSuccess: push-page
    page:
      type: list
      mode: filter
    params:
      repository:
        type: string
