name: github
version: "1.0"
title: GitHub
requirements:
  - homePage: https://cli.github.com
    which: gh
rootItems:
  - title: List My Repositories
    script: list-repositories
    with:
      owner: pomdtr
  - title: List Owner Repositories
    script: list-repositories
  - title: List Dailymotion Repositories
    script: list-repositories
    with:
      owner: dailymotion
  - title: List Airflow Pull Requests
    script: list-pull-requests
    with:
      repository: dailymotion/dwh-dags
scripts:
  view-readme:
    mode: detail
    command: |
      gh api repos/${{repository}}/readme --jq '
      {
        preview: (.content | @base64d),
        metadatas: [
          {
            title: "Repository",
            value: "${{repository}}"
          }
        ],
        actions: [
          { type: "open-url", title: "Open in Browser", url: .html_url }
        ]
      }
      '
    params:
      - name: repository
        input:
          type: textfield
          required: true
          title: Repository
  list-repositories:
    command: ./list-repos.sh ${{ owner }}
    mode: filter
    showPreview: true
    params:
      - name: owner
        input:
          type: textfield
          title: Owner
          required: true
  list-pull-requests:
    command: ./list-prs.sh ${{ repository }}
    mode: filter
    params:
      - name: repository
        input:
          type: textfield
          title: Repository
          required: true
