name: devdocs
title: DevDocs
version: "1.0"
requirements:
  - which: curl
    homePage: https://curl.se
rootItems:
  - script: searchDocsets
    title: Browse Docset
  - script: searchEntries
    title: Python 3.11
    with:
      slug: python~3.11
scripts:
  searchDocsets:
    command: |
      curl https://devdocs.io/docs/docs.json | sunbeam query '.[] |
        {
          title: .name,
          subtitle: .release,
          actions: [
            { type: "runScript", script: "searchEntries", title: "Search Entries", with: { slug: .slug } },
            { type: "openUrl", title: "Open in Browser", url: "https://devdocs.io/\(.slug)" }
          ]
        }
      '
    output: page
    page:
      type: list
      mode: filter
  searchEntries:
    command: |
      curl https://devdocs.io/docs/{{ slug }}/index.json | sunbeam query '.entries[] |
        {
          title: .name,
          subtitle: .type,
          actions: [
            {type: "openUrl", url: "https://devdocs.io/{{ slug }}/\(.path)"}
          ]
        }
      '
    output: page
    page:
      type: list
      mode: filter
    params:
      slug:
        type: string
